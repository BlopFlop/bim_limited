# Бот для компании BIM Limited (команда Артура)

## О проекте БИМЛТД
Чат-бот для компании **BIM Limite** - консьерж-сервиса в сфере предоставления полного спектра услуг по проектированию, поставке, монтажу и обслуживанию систем вентиляции, кондиционирования и увлажнения воздуха. Компания позиционирует себя как премиум-сервис, предлагающий индивидуальный подход к каждому клиенту, включая разработку решений под ключ для объектов любой сложности.

**Цели:** 

Основные функции чат-бота:

- **Запрос от клиента:** Пользователь (например, клиент, прораб или дизайнер) начинает диалог с чат-ботом, указывая свои потребности или интересующие системы.
- **Предоставление вариантов:** Чат-бот предлагает клиенту различные типы товаров (вентиляция, кондиционирование, увлажнение и т.д.) на основе введенной информации.
- **Фильтрация по характеристикам:** Клиент выбирает параметры (мощность, производительность, габариты, цена и т.д.), которые ему интересны.
- **Предложения по маркам:** На основе выбранных характеристик чат-бот предлагает список брендов и моделей, соответствующих запросу.
- **Предоставление PDF с информацией:** После выбора конкретной марки и модели клиент получает PDF-страницу из каталога с подробной технической информацией об этом товаре.

Разработка такого чат-бота позволит компании улучшить взаимодействие с клиентами, упростить процесс выбора оборудования и повысить эффективность внутренней работы.

## Настройка

### Репозиторий
- Базовая рабочая ветка - develop. Здесь располагается "чистый" основной рабочий код после ревью. Все остальные ветки создаем только от нее
**Все объединения проводятся исключительно через Pull requests**
- ‼️ Ветка `master` - ветка для чистого кода, подготовленного к деплою на сервер.
- Правила именования веток:
  - `feature/<краткое описание>` - для веток, реализующих основной и дополнительный функционал ТЗ
  - `fix/<краткое описание>` - для веток, исправляющих или дополняющие уже реализованный функционал


### Настройка после клонирования репозитория

После клонирования репозиторий имеет следующую структуру:

```
bim_ltd_team_1
│
├── infra/                              Каталог с файлами инфраструктуры
│   ├── env.example                     Пример конфигурационного файла
│   └── dev-docker-compose.yml          Настройки для docker compose
│
├── src/                                Каталог с файлами проекта
|   └── __init__.py
│   └── main.py                         Основной запускаемый файл проекта
│   └── admin/                          Админка
│   └── core/                           Настройки проекта
|   |   └── __init__.py
|   |   └── base.py                     Настройки бд
|   |   └── config.py                   Конфигурация проекта
|   |   └── db.py                       Настройки бд
|   └── handlers/                       Обработчики сообщений
|   └── keyboards/                      Обработчики сообщений
|   └── models/                         Модели ДБ
|   └── text/                           Текстовые сообщения
|   └── utils/                          Вспомогательный модуль
│
├── tests/                              Тестирование
|   └── conftest.py                     Тестовые компоненты
│
├── .gitignore                          Что игнорировать в Git
├── requirements.txt                    Основные зависимости проекта
├── requirements_style.txt              Зависимости для стилизации кода
├── .pre-commit-config.yaml             Настройки для проверок перед комитом
├── style.cfg                           Настройки для isort и flake8
├── black.cfg                           Настройки для black
└── README.md                           Этот файл
```

‼️ **Мы работаем с Python 3.11** ‼️

Устанавливаем и активируем виртуальное окружение

```shell
python3.11 -m venv .venv
source .venv/bin/activate
```

Устанавливаем зависимости
```shell
pip install -r requirements.txt
pip install -r requirements_style.txt
```

Настраиваем `pre-commit`

```shell
pre-commit install
```

Проверяем, что `pre-commit` работает корректно

```shell
pre-commit run --all-files
```

Возможно потребуется запуск несколько раз. В итоге должен получиться примерно такой вывод:

```shell
trim trailing whitespace............Passed
fix end of files....................Passed
check yaml..........................Passed
check for added large files.........Passed
check for merge conflicts...........Passed
isort...............................Passed
flake8..............................Passed
black...............................Passed
```
#Запуск проекта
Пример .env
BOT_TOKEN = # Токен бота, полученный при регистрации бота в Telegram
```
POSTGRES_USER=your_db_username # Заменить
POSTGRES_PASSWORD=your_db_password # Заменить
POSTGRES_DB=bim_ltd
POSTGRES_SERVER=localhost # Изменить на название контейнера с БД в Docker Compose
POSTGRES_PORT=5432
ADMIN_USER_MODEL=AdministrationUser
ADMIN_USER_MODEL_USERNAME_FIELD=email
FIRST_SUPERUSER_EMAIL=test@mail.com # Заменить
FIRST_SUPERUSER_PASSWORD=testpass # Заменить
NAME_COMPANY=test # Заменить
ADMIN_SECRET_KEY=testsecret # Заменить
SECRET=testsecret # Заменить
CONSULTATE_URL=https://bimltd.ru/#contacts
CONSULTATE_NUMBER=+74953797944
CONSULTATE_MAIL=bim@bimltd.ru
CONSULTATE_TELEGRAM=https://t.me/Vanya_Boevik
DIRECTORY_LOGO_MAKER=media/logo_maker
DIRECTORY_IMAGE_EQUIPMENT=media/image_equipment
DIRECTORY_PDF=media/pdf
```
Добавить папку src в рабочую директорию
```
```
Перейти в папку src
```
cd src
```
Запустить проект через терминал командой
```
python main.py
```
Для развертывания проетка локально на своем пк перейдите в папку infra
```
cd ..
cd infra
```
Запустите docker compose
```
docker compose up
```
Для развертывания на сервере необходимо запушить изменеия в ветку main и он автоматически развернется
